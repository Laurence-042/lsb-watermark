(function(t){function e(e){for(var n,r,o=e[0],l=e[1],c=e[2],g=0,d=[];g<o.length;g++)r=o[g],Object.prototype.hasOwnProperty.call(i,r)&&i[r]&&d.push(i[r][0]),i[r]=0;for(n in l)Object.prototype.hasOwnProperty.call(l,n)&&(t[n]=l[n]);h&&h(e);while(d.length)d.shift()();return s.push.apply(s,c||[]),a()}function a(){for(var t,e=0;e<s.length;e++){for(var a=s[e],n=!0,o=1;o<a.length;o++){var l=a[o];0!==i[l]&&(n=!1)}n&&(s.splice(e--,1),t=r(r.s=a[0]))}return t}var n={},i={app:0},s=[];function r(e){if(n[e])return n[e].exports;var a=n[e]={i:e,l:!1,exports:{}};return t[e].call(a.exports,a,a.exports,r),a.l=!0,a.exports}r.m=t,r.c=n,r.d=function(t,e,a){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:a})},r.r=function(t){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"===typeof t&&t&&t.__esModule)return t;var a=Object.create(null);if(r.r(a),Object.defineProperty(a,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var n in t)r.d(a,n,function(e){return t[e]}.bind(null,n));return a},r.n=function(t){var e=t&&t.__esModule?function(){return t["default"]}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="/lsb-watermark/";var o=window["webpackJsonp"]=window["webpackJsonp"]||[],l=o.push.bind(o);o.push=e,o=o.slice();for(var c=0;c<o.length;c++)e(o[c]);var h=l;s.push([0,"chunk-vendors"]),a()})({0:function(t,e,a){t.exports=a("56d7")},"034f":function(t,e,a){"use strict";var n=a("85ec"),i=a.n(n);i.a},"56d7":function(t,e,a){"use strict";a.r(e);a("e260"),a("e6cf"),a("cca6"),a("a79d");var n=a("2b0e"),i=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("v-app",[a("v-app-bar",{attrs:{app:"",color:"blue darken-3",dark:""}},[a("v-file-input",{attrs:{accept:"image/*",label:"选择待加工图片"},on:{change:t.selectMainImage}}),a("v-file-input",{attrs:{accept:"image/*",label:"选择水印（提取模式置空）"},on:{change:t.selectSecondImage}}),a("v-btn",{attrs:{text:""},on:{click:t.process}},[t._v("执行")]),a("v-slider",{attrs:{label:"水印位数",min:"2",max:"4"},model:{value:t.watermarkBits,callback:function(e){t.watermarkBits=e},expression:"watermarkBits"}}),a("v-spacer"),a("v-btn",{attrs:{href:"https://github.com/Laurence-042/lsb-watermark",target:"_blank",text:""}},[a("span",[t._v("在Github查看代码")]),a("v-icon",[t._v("mdi-open-in-new")])],1)],1),a("v-main",[a("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[a("v-row",{attrs:{align:"center",justify:"center"}},[a("div",{directives:[{name:"show",rawName:"v-show",value:null==t.firstImg,expression:"firstImg == null"}]},[a("p",{staticClass:"text-center text-h6"},[t._v("请先在顶栏处选取图片")]),a("p",{staticClass:"text-center"},[t._v("使用方法：")]),a("ol",[a("li",[t._v(" 添加水印 "),a("ol",[a("li",[t._v("使用顶栏左侧上传待处理图片")]),a("li",[t._v("使用顶栏右侧上传作为水印的图片")]),a("li",[t._v("点击顶栏上的“执行”按钮")])])]),a("li",[t._v(" 提取水印 "),a("ol",[a("li",[t._v("使用顶栏左侧上传待处理图片")]),a("li",[t._v("（右侧留空）")]),a("li",[t._v("点击顶栏上的“执行”按钮")])])]),a("li",[t._v(" 水印位数默认为4，但对于某些图来说这个值高到足以让水印显现，您可能会想将其调到3或2 "),a("br"),t._v(" （请不要试图将其调到4以上或者2以下。我试过，那不好玩，所以我用滑条把它固定在了2、3、4这三个值） ")]),a("li",[t._v(" 如果您使用4提取水印时发现还掺杂了原图的元素，那么可能是因为加水印时使用了2或3。 "),a("br"),t._v(" 简单地调整水印位数然后再次点击执行即可！ "),a("br"),t._v(" 但加水印时请不要这么做，除非您准备增大水印位数 "),a("br"),t._v(" ——因为我很懒，我没有加第三块canvas，加水印时是直接在原canvas上改的 ")])])]),a("div",{directives:[{name:"show",rawName:"v-show",value:null!=t.firstImg,expression:"firstImg != null"}],staticClass:"d-flex flex-column justify-center align-center full-width",attrs:{id:"inputArea"}},[a("img",{staticClass:"full-width center-background",attrs:{src:t.imageOut}})]),a("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"full-width",attrs:{id:"main_canvas"}}),a("canvas",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"full-width",attrs:{id:"second_canvas"}})])],1)],1)],1)},s=[],r=(a("ac1f"),a("1276"),a("d3b7"),a("25f0"),{copyPixel:function(t,e,a,n){var i=this.getPixel(t,a,n);this.setPixel(e,a,n,i)},RgbaToHEX:function(t){return"#"+t.r.toString(16)+t.g.toString(16)+t.b.toString(16)+t.a.toString(16)},GetRgbaDistance:function(t,e){return Math.pow(t.r-e.r,2)+Math.pow(t.g-e.g,2)+Math.pow(t.b-e.b,2)+Math.pow(t.a-e.a,2)},getPixelChannel:function(t,e,a,n){return t.data[e*(4*t.width)+4*a+n]},setPixelChannel:function(t,e,a,n,i){t.data[e*(4*t.width)+4*a+n]=i},getPixel:function(t,e,a){return{r:this.getPixelChannel(t,e,a,0),g:this.getPixelChannel(t,e,a,1),b:this.getPixelChannel(t,e,a,2),a:this.getPixelChannel(t,e,a,3)}},setPixel:function(t,e,a,n){this.setPixelChannel(t,e,a,0,n.r),this.setPixelChannel(t,e,a,1,n.g),this.setPixelChannel(t,e,a,2,n.b),this.setPixelChannel(t,e,a,3,n.a)},addPixelNoClamp:function(t,e){return{r:t.r+e.r,g:t.g+e.g,b:t.b+e.b,a:t.a+e.a}},clampTo254Copy:function(t){for(var e=new ImageData(t.width,t.height),a=0;a<t.width;a++)for(var n=0;n<t.height;n++){var i=r.getPixel(t,n,a);i.r=255==i.r?254:i.r,i.g=255==i.g?254:i.g,i.b=255==i.b?254:i.b,this.setPixel(e,n,a,i)}return e},gaussianFilterNoiseReductionCopy:function(t,e){if(0!=e){for(var a=new ImageData(t.width,t.height),n=0;n<t.width;n++)for(var i=0;i<t.height;i++)this.setPixel(a,i,n,s(i,n));return a}function s(a,n){for(var i=Math.max(0,n-e),s=Math.min(t.width-1,n+e),o=Math.max(0,a-e),l=Math.min(t.height-1,a+e),c=(s-i)*(l-o),h={r:0,g:0,b:0,a:0},g=i;g<s;g++)for(var d=o;d<l;d++)h=r.addPixelNoClamp(h,r.getPixel(t,d,g));return{r:h.r/c,g:h.g/c,b:h.b/c,a:h.a/c}}},matrix:function(t,e,a){for(var n=[],i=0;i<t;i++){n.push([]),n[i].push(new Array(e));for(var s=0;s<e;s++)n[i][s]=a}return n}}),o=r,l={name:"App",data:function(){return{watermarkBits:4,firstImg:null,secondImg:null,imageOut:null,dx:0,dy:0,main_canvas:null,second_canvas:null}},mounted:function(){this.main_canvas=document.getElementById("main_canvas"),this.second_canvas=document.getElementById("second_canvas")},methods:{selectMainImage:function(t){var e=this;if(null==t)return this.firstImg=null,this.secondImg=null,void(this.imageOut=null);this.selectImage(t,(function(t){var a=e.main_canvas.getContext("2d");e.main_canvas.width=t.width,e.main_canvas.height=t.height,a.drawImage(t,0,0),e.firstImg=t}))},selectSecondImage:function(t){var e=this;null!=t?null!=this.firstImg?this.selectImage(t,(function(t){var a=e.second_canvas.getContext("2d");e.second_canvas.width=e.main_canvas.width,e.second_canvas.height=e.main_canvas.height,console.log("main:"+e.main_canvas.width+" "+e.main_canvas.height),console.log("main img:"+e.firstImg.width+" "+e.firstImg.height),console.log("set second canvas to:"+e.second_canvas.width+" "+e.second_canvas.height),console.log(e.firstImg.width/t.width+" "+e.firstImg.height/t.height);var n=Math.min(e.firstImg.width/t.width,e.firstImg.height/t.height),i=Math.ceil(t.width*n),s=Math.ceil(t.height*n);console.log("scale second from:"+t.width+" "+t.height),console.log("to:"+i+" "+s),e.dx=Math.ceil(e.second_canvas.width/2-i/2),e.dy=Math.ceil(e.second_canvas.height/2-s/2),a.drawImage(t,e.dx,e.dy,i,s),e.secondImg=t})):console.log("main first"):this.secondImg=null},selectImage:function(t,e){var a=new FileReader;a.readAsDataURL(t),a.onload=function(t){var a=t.target.result;console.log("image readed");var n=new Image;n.onload=function(){console.log("image loaded"),e(n)},n.src=a}},process:function(){null!=this.secondImg?this.merge():this.split(),this.processed=!0},merge:function(){console.log("merge");var t=this.main_canvas.getContext("2d"),e=this.second_canvas.getContext("2d");console.log("main:"+t.width+" "+t.height),console.log("second:"+e.width+" "+e.height);for(var a=t.getImageData(0,0,this.main_canvas.width,this.main_canvas.height),n=e.getImageData(0,0,this.second_canvas.width,this.second_canvas.height),i=Math.pow(2,this.watermarkBits),s=256/Math.pow(2,this.watermarkBits),r=this.dy;r<a.height-this.dy;r++)for(var l=this.dx;l<a.width-this.dx;l++){var c=o.getPixel(a,r,l),h=o.getPixel(n,r,l);c.r=Math.floor(c.r/i)*i+Math.floor(h.r/s),c.g=Math.floor(c.g/i)*i+Math.floor(h.g/s),c.b=Math.floor(c.b/i)*i+Math.floor(h.b/s),o.setPixel(a,r,l,c)}t.putImageData(a,0,0),this.imageOut=this.main_canvas.toDataURL(),this.isImageProcessed=!0},split:function(){console.log("split");var t=this.main_canvas.getContext("2d"),e=this.second_canvas.getContext("2d");this.second_canvas.width=this.main_canvas.width,this.second_canvas.height=this.main_canvas.height,console.log("main:"+t.width+" "+t.height);for(var a=t.getImageData(0,0,this.main_canvas.width,this.main_canvas.height),n=e.getImageData(0,0,this.second_canvas.width,this.second_canvas.height),i=Math.pow(2,this.watermarkBits),s=256/Math.pow(2,this.watermarkBits),r=0;r<a.height;r++)for(var l=0;l<a.width;l++){var c=o.getPixel(a,r,l);c.r=c.r%i*s,c.g=c.g%i*s,c.b=c.b%i*s,o.setPixel(n,r,l,c)}e.putImageData(n,0,0),this.imageOut=this.second_canvas.toDataURL(),this.isImageProcessed=!0}}},c=l,h=(a("034f"),a("2877")),g=a("6544"),d=a.n(g),u=a("7496"),v=a("40dc"),m=a("8336"),f=a("a523"),p=a("23a7"),w=a("132d"),_=a("f6c4"),b=a("0fd9"),x=a("ba0d"),I=a("2fa4"),P=Object(h["a"])(c,i,s,!1,null,null,null),y=P.exports;d()(P,{VApp:u["a"],VAppBar:v["a"],VBtn:m["a"],VContainer:f["a"],VFileInput:p["a"],VIcon:w["a"],VMain:_["a"],VRow:b["a"],VSlider:x["a"],VSpacer:I["a"]});var M=a("f309");n["a"].use(M["a"]);var C=new M["a"]({});n["a"].config.productionTip=!1,new n["a"]({vuetify:C,render:function(t){return t(y)}}).$mount("#app")},"85ec":function(t,e,a){}});
//# sourceMappingURL=app.d53ba0b3.js.map